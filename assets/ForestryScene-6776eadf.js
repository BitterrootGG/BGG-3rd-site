import{g as mt,r as i,_ as pe,e as pt,u as bt,a as gt,c as xt,i as yt,E as Mt,B as wt,b as vt,T as Et,d as jt,f as Pt,Q as Ne,P as ue,V as D,O as de,S as ke,h as H,M as ee,j as te,R as St,k as Tt,l as F,m as Ot,n as ne,W as At,C as Ct,o as Rt,p as zt,q as s,s as It,t as ie,v as he,w as Lt,x as C,F as _t,y as Dt,D as Gt}from"./index-fcb9c602.js";function ve(r,n,o){var e,l,c,p,u;n==null&&(n=100);function a(){var h=Date.now()-p;h<n&&h>=0?e=setTimeout(a,n-h):(e=null,o||(u=r.apply(c,l),c=l=null))}var S=function(){c=this,l=arguments,p=Date.now();var h=o&&!e;return e||(e=setTimeout(a,n)),h&&(u=r.apply(c,l),c=l=null),u};return S.clear=function(){e&&(clearTimeout(e),e=null)},S.flush=function(){e&&(u=r.apply(c,l),c=l=null,clearTimeout(e),e=null)},S}ve.debounce=ve;var Nt=ve;const Fe=mt(Nt);function kt(r){let{debounce:n,scroll:o,polyfill:e,offsetSize:l}=r===void 0?{debounce:0,scroll:!1,offsetSize:!1}:r;const c=e||(typeof window>"u"?class{}:window.ResizeObserver);if(!c)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[p,u]=i.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=i.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:p}),S=n?typeof n=="number"?n:n.scroll:null,h=n?typeof n=="number"?n:n.resize:null,b=i.useRef(!1);i.useEffect(()=>(b.current=!0,()=>void(b.current=!1)));const[g,d,E]=i.useMemo(()=>{const P=()=>{if(!a.current.element)return;const{left:L,top:R,width:v,height:y,bottom:_,right:O,x:A,y:x}=a.current.element.getBoundingClientRect(),I={left:L,top:R,width:v,height:y,bottom:_,right:O,x:A,y:x};a.current.element instanceof HTMLElement&&l&&(I.height=a.current.element.offsetHeight,I.width=a.current.element.offsetWidth),Object.freeze(I),b.current&&!Yt(a.current.lastBounds,I)&&u(a.current.lastBounds=I)};return[P,h?Fe(P,h):P,S?Fe(P,S):P]},[u,l,S,h]);function m(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(P=>P.removeEventListener("scroll",E,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null)}function T(){a.current.element&&(a.current.resizeObserver=new c(E),a.current.resizeObserver.observe(a.current.element),o&&a.current.scrollContainers&&a.current.scrollContainers.forEach(P=>P.addEventListener("scroll",E,{capture:!0,passive:!0})))}const j=P=>{!P||P===a.current.element||(m(),a.current.element=P,a.current.scrollContainers=qe(P),T())};return Ut(E,!!o),Ft(d),i.useEffect(()=>{m(),T()},[o,E,d]),i.useEffect(()=>m,[]),[j,p,g]}function Ft(r){i.useEffect(()=>{const n=r;return window.addEventListener("resize",n),()=>void window.removeEventListener("resize",n)},[r])}function Ut(r,n){i.useEffect(()=>{if(n){const o=r;return window.addEventListener("scroll",o,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",o,!0)}},[r,n])}function qe(r){const n=[];if(!r||r===document.body)return n;const{overflow:o,overflowX:e,overflowY:l}=window.getComputedStyle(r);return[o,e,l].some(c=>c==="auto"||c==="scroll")&&n.push(r),[...n,...qe(r.parentElement)]}const Ht=["x","y","top","bottom","left","right","width","height"],Yt=(r,n)=>Ht.every(o=>r[o]===n[o]);var Bt=Object.defineProperty,Xt=Object.defineProperties,Wt=Object.getOwnPropertyDescriptors,Ue=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,He=(r,n,o)=>n in r?Bt(r,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[n]=o,Ye=(r,n)=>{for(var o in n||(n={}))Zt.call(n,o)&&He(r,o,n[o]);if(Ue)for(var o of Ue(n))Vt.call(n,o)&&He(r,o,n[o]);return r},Kt=(r,n)=>Xt(r,Wt(n));function Qe(r,n,o){if(!r)return;if(o(r)===!0)return r;let e=n?r.return:r.child;for(;e;){const l=Qe(e,n,o);if(l)return l;e=n?null:e.sibling}}function $e(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const Ee=$e(i.createContext(null));class Je extends i.Component{render(){return i.createElement(Ee.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:Be,ReactCurrentDispatcher:Xe}=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function qt(){const r=i.useContext(Ee);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const n=i.useId();return i.useMemo(()=>{for(const e of[Be==null?void 0:Be.current,r,r==null?void 0:r.alternate]){if(!e)continue;const l=Qe(e,!1,c=>{let p=c.memoizedState;for(;p;){if(p.memoizedState===n)return!0;p=p.next}});if(l)return l}},[r,n])}function Qt(){var r,n;const o=qt(),[e]=i.useState(()=>new Map);e.clear();let l=o;for(;l;){const c=(r=l.type)==null?void 0:r._context;c&&c!==Ee&&!e.has(c)&&e.set(c,(n=Xe==null?void 0:Xe.current)==null?void 0:n.readContext($e(c))),l=l.return}return e}function $t(){const r=Qt();return i.useMemo(()=>Array.from(r.keys()).reduce((n,o)=>e=>i.createElement(n,null,i.createElement(o.Provider,Kt(Ye({},e),{value:r.get(o)}))),n=>i.createElement(Je,Ye({},n))),[r])}const we={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Jt(r){const{handlePointer:n}=jt(r);return{priority:1,enabled:!0,compute(o,e,l){e.pointer.set(o.offsetX/e.size.width*2-1,-(o.offsetY/e.size.height)*2+1),e.raycaster.setFromCamera(e.pointer,e.camera)},connected:void 0,handlers:Object.keys(we).reduce((o,e)=>({...o,[e]:n(e)}),{}),update:()=>{var o;const{events:e,internal:l}=r.getState();(o=l.lastEvent)!=null&&o.current&&e.handlers&&e.handlers.onPointerMove(l.lastEvent.current)},connect:o=>{var e;const{set:l,events:c}=r.getState();c.disconnect==null||c.disconnect(),l(p=>({events:{...p.events,connected:o}})),Object.entries((e=c.handlers)!=null?e:[]).forEach(([p,u])=>{const[a,S]=we[p];o.addEventListener(a,u,{passive:S})})},disconnect:()=>{const{set:o,events:e}=r.getState();if(e.connected){var l;Object.entries((l=e.handlers)!=null?l:[]).forEach(([c,p])=>{if(e&&e.connected instanceof HTMLElement){const[u]=we[c];e.connected.removeEventListener(u,p)}}),o(c=>({events:{...c.events,connected:void 0}}))}}}}const en=i.forwardRef(function({children:n,fallback:o,resize:e,style:l,gl:c,events:p=Jt,eventSource:u,eventPrefix:a,shadows:S,linear:h,flat:b,legacy:g,orthographic:d,frameloop:E,dpr:m,performance:T,raycaster:j,camera:P,onPointerMissed:L,onCreated:R,...v},y){i.useMemo(()=>pt(Et),[]);const _=$t(),[O,A]=kt({scroll:!0,debounce:{scroll:50,resize:0},...e}),x=i.useRef(null),I=i.useRef(null);i.useImperativeHandle(y,()=>x.current);const N=bt(L),[k,B]=i.useState(!1),[X,Q]=i.useState(!1);if(k)throw k;if(X)throw X;const U=i.useRef(null);gt(()=>{const W=x.current;A.width>0&&A.height>0&&W&&(U.current||(U.current=xt(W)),U.current.configure({gl:c,events:p,shadows:S,linear:h,flat:b,legacy:g,orthographic:d,frameloop:E,dpr:m,performance:T,raycaster:j,camera:P,size:A,onPointerMissed:(...Z)=>N.current==null?void 0:N.current(...Z),onCreated:Z=>{Z.events.connect==null||Z.events.connect(u?yt(u)?u.current:u:I.current),a&&Z.setEvents({compute:(re,Y)=>{const ce=re[a+"X"],be=re[a+"Y"];Y.pointer.set(ce/Y.size.width*2-1,-(be/Y.size.height)*2+1),Y.raycaster.setFromCamera(Y.pointer,Y.camera)}}),R==null||R(Z)}}),U.current.render(i.createElement(_,null,i.createElement(Mt,{set:Q},i.createElement(i.Suspense,{fallback:i.createElement(wt,{set:B})},n)))))}),i.useEffect(()=>{const W=x.current;if(W)return()=>vt(W)},[]);const $=u?"none":"auto";return i.createElement("div",pe({ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:$,...l}},v),i.createElement("div",{ref:O,style:{width:"100%",height:"100%"}},i.createElement("canvas",{ref:x,style:{display:"block"}},o)))}),tn=i.forwardRef(function(n,o){return i.createElement(Je,null,i.createElement(en,pe({},n,{ref:o})))});var nn=Object.defineProperty,rn=(r,n,o)=>n in r?nn(r,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[n]=o,M=(r,n,o)=>(rn(r,typeof n!="symbol"?n+"":n,o),o);const fe=new St,We=new Tt,on=Math.cos(70*(Math.PI/180)),Ze=(r,n)=>(r%n+n)%n;let sn=class extends Pt{constructor(n,o){super(),M(this,"object"),M(this,"domElement"),M(this,"enabled",!0),M(this,"target",new D),M(this,"minDistance",0),M(this,"maxDistance",1/0),M(this,"minZoom",0),M(this,"maxZoom",1/0),M(this,"minPolarAngle",0),M(this,"maxPolarAngle",Math.PI),M(this,"minAzimuthAngle",-1/0),M(this,"maxAzimuthAngle",1/0),M(this,"enableDamping",!1),M(this,"dampingFactor",.05),M(this,"enableZoom",!0),M(this,"zoomSpeed",1),M(this,"enableRotate",!0),M(this,"rotateSpeed",1),M(this,"enablePan",!0),M(this,"panSpeed",1),M(this,"screenSpacePanning",!0),M(this,"keyPanSpeed",7),M(this,"zoomToCursor",!1),M(this,"autoRotate",!1),M(this,"autoRotateSpeed",2),M(this,"reverseOrbit",!1),M(this,"reverseHorizontalOrbit",!1),M(this,"reverseVerticalOrbit",!1),M(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),M(this,"mouseButtons",{LEFT:ee.ROTATE,MIDDLE:ee.DOLLY,RIGHT:ee.PAN}),M(this,"touches",{ONE:te.ROTATE,TWO:te.DOLLY_PAN}),M(this,"target0"),M(this,"position0"),M(this,"zoom0"),M(this,"_domElementKeyEvents",null),M(this,"getPolarAngle"),M(this,"getAzimuthalAngle"),M(this,"setPolarAngle"),M(this,"setAzimuthalAngle"),M(this,"getDistance"),M(this,"listenToKeyEvents"),M(this,"stopListenToKeyEvents"),M(this,"saveState"),M(this,"reset"),M(this,"update"),M(this,"connect"),M(this,"dispose"),this.object=n,this.domElement=o,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=t=>{let f=Ze(t,2*Math.PI),w=h.phi;w<0&&(w+=2*Math.PI),f<0&&(f+=2*Math.PI);let z=Math.abs(f-w);2*Math.PI-z<z&&(f<w?f+=2*Math.PI:w+=2*Math.PI),b.phi=f-w,e.update()},this.setAzimuthalAngle=t=>{let f=Ze(t,2*Math.PI),w=h.theta;w<0&&(w+=2*Math.PI),f<0&&(f+=2*Math.PI);let z=Math.abs(f-w);2*Math.PI-z<z&&(f<w?f+=2*Math.PI:w+=2*Math.PI),b.theta=f-w,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",ye),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ye),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(l),e.update(),a=u.NONE},this.update=(()=>{const t=new D,f=new D(0,1,0),w=new Ne().setFromUnitVectors(n.up,f),z=w.clone().invert(),G=new D,V=new Ne,J=2*Math.PI;return function(){const Ge=e.object.position;w.setFromUnitVectors(n.up,f),z.copy(w).invert(),t.copy(Ge).sub(e.target),t.applyQuaternion(w),h.setFromVector3(t),e.autoRotate&&a===u.NONE&&B(N()),e.enableDamping?(h.theta+=b.theta*e.dampingFactor,h.phi+=b.phi*e.dampingFactor):(h.theta+=b.theta,h.phi+=b.phi);let K=e.minAzimuthAngle,q=e.maxAzimuthAngle;isFinite(K)&&isFinite(q)&&(K<-Math.PI?K+=J:K>Math.PI&&(K-=J),q<-Math.PI?q+=J:q>Math.PI&&(q-=J),K<=q?h.theta=Math.max(K,Math.min(q,h.theta)):h.theta=h.theta>(K+q)/2?Math.max(K,h.theta):Math.min(q,h.theta)),h.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,h.phi)),h.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(d,e.dampingFactor):e.target.add(d),e.zoomToCursor&&A||e.object.isOrthographicCamera?h.radius=Y(h.radius):h.radius=Y(h.radius*g),t.setFromSpherical(h),t.applyQuaternion(z),Ge.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(b.theta*=1-e.dampingFactor,b.phi*=1-e.dampingFactor,d.multiplyScalar(1-e.dampingFactor)):(b.set(0,0,0),d.set(0,0,0));let oe=!1;if(e.zoomToCursor&&A){let se=null;if(e.object instanceof ue&&e.object.isPerspectiveCamera){const ae=t.length();se=Y(ae*g);const le=ae-se;e.object.position.addScaledVector(_,le),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const ae=new D(O.x,O.y,0);ae.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/g)),e.object.updateProjectionMatrix(),oe=!0;const le=new D(O.x,O.y,0);le.unproject(e.object),e.object.position.sub(le).add(ae),e.object.updateMatrixWorld(),se=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;se!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(se).add(e.object.position):(fe.origin.copy(e.object.position),fe.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(fe.direction))<on?n.lookAt(e.target):(We.setFromNormalAndCoplanarPoint(e.object.up,e.target),fe.intersectPlane(We,e.target))))}else e.object instanceof de&&e.object.isOrthographicCamera&&(oe=g!==1,oe&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/g)),e.object.updateProjectionMatrix()));return g=1,A=!1,oe||G.distanceToSquared(e.object.position)>S||8*(1-V.dot(e.object.quaternion))>S?(e.dispatchEvent(l),G.copy(e.object.position),V.copy(e.object.quaternion),oe=!1,!0):!1}})(),this.connect=t=>{t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",Le),e.domElement.addEventListener("pointerdown",Re),e.domElement.addEventListener("pointercancel",ze),e.domElement.addEventListener("wheel",Ie)},this.dispose=()=>{var t,f,w,z,G,V;(t=e.domElement)==null||t.removeEventListener("contextmenu",Le),(f=e.domElement)==null||f.removeEventListener("pointerdown",Re),(w=e.domElement)==null||w.removeEventListener("pointercancel",ze),(z=e.domElement)==null||z.removeEventListener("wheel",Ie),(G=e.domElement)==null||G.ownerDocument.removeEventListener("pointermove",ge),(V=e.domElement)==null||V.ownerDocument.removeEventListener("pointerup",xe),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",ye)};const e=this,l={type:"change"},c={type:"start"},p={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=u.NONE;const S=1e-6,h=new ke,b=new ke;let g=1;const d=new D,E=new H,m=new H,T=new H,j=new H,P=new H,L=new H,R=new H,v=new H,y=new H,_=new D,O=new H;let A=!1;const x=[],I={};function N(){return 2*Math.PI/60/60*e.autoRotateSpeed}function k(){return Math.pow(.95,e.zoomSpeed)}function B(t){e.reverseOrbit||e.reverseHorizontalOrbit?b.theta+=t:b.theta-=t}function X(t){e.reverseOrbit||e.reverseVerticalOrbit?b.phi+=t:b.phi-=t}const Q=(()=>{const t=new D;return function(w,z){t.setFromMatrixColumn(z,0),t.multiplyScalar(-w),d.add(t)}})(),U=(()=>{const t=new D;return function(w,z){e.screenSpacePanning===!0?t.setFromMatrixColumn(z,1):(t.setFromMatrixColumn(z,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(w),d.add(t)}})(),$=(()=>{const t=new D;return function(w,z){const G=e.domElement;if(G&&e.object instanceof ue&&e.object.isPerspectiveCamera){const V=e.object.position;t.copy(V).sub(e.target);let J=t.length();J*=Math.tan(e.object.fov/2*Math.PI/180),Q(2*w*J/G.clientHeight,e.object.matrix),U(2*z*J/G.clientHeight,e.object.matrix)}else G&&e.object instanceof de&&e.object.isOrthographicCamera?(Q(w*(e.object.right-e.object.left)/e.object.zoom/G.clientWidth,e.object.matrix),U(z*(e.object.top-e.object.bottom)/e.object.zoom/G.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function W(t){e.object instanceof ue&&e.object.isPerspectiveCamera||e.object instanceof de&&e.object.isOrthographicCamera?g/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Z(t){e.object instanceof ue&&e.object.isPerspectiveCamera||e.object instanceof de&&e.object.isOrthographicCamera?g*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function re(t){if(!e.zoomToCursor||!e.domElement)return;A=!0;const f=e.domElement.getBoundingClientRect(),w=t.clientX-f.left,z=t.clientY-f.top,G=f.width,V=f.height;O.x=w/G*2-1,O.y=-(z/V)*2+1,_.set(O.x,O.y,1).unproject(e.object).sub(e.object.position).normalize()}function Y(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function ce(t){E.set(t.clientX,t.clientY)}function be(t){re(t),R.set(t.clientX,t.clientY)}function je(t){j.set(t.clientX,t.clientY)}function et(t){m.set(t.clientX,t.clientY),T.subVectors(m,E).multiplyScalar(e.rotateSpeed);const f=e.domElement;f&&(B(2*Math.PI*T.x/f.clientHeight),X(2*Math.PI*T.y/f.clientHeight)),E.copy(m),e.update()}function tt(t){v.set(t.clientX,t.clientY),y.subVectors(v,R),y.y>0?W(k()):y.y<0&&Z(k()),R.copy(v),e.update()}function nt(t){P.set(t.clientX,t.clientY),L.subVectors(P,j).multiplyScalar(e.panSpeed),$(L.x,L.y),j.copy(P),e.update()}function rt(t){re(t),t.deltaY<0?Z(k()):t.deltaY>0&&W(k()),e.update()}function ot(t){let f=!1;switch(t.code){case e.keys.UP:$(0,e.keyPanSpeed),f=!0;break;case e.keys.BOTTOM:$(0,-e.keyPanSpeed),f=!0;break;case e.keys.LEFT:$(e.keyPanSpeed,0),f=!0;break;case e.keys.RIGHT:$(-e.keyPanSpeed,0),f=!0;break}f&&(t.preventDefault(),e.update())}function Pe(){if(x.length==1)E.set(x[0].pageX,x[0].pageY);else{const t=.5*(x[0].pageX+x[1].pageX),f=.5*(x[0].pageY+x[1].pageY);E.set(t,f)}}function Se(){if(x.length==1)j.set(x[0].pageX,x[0].pageY);else{const t=.5*(x[0].pageX+x[1].pageX),f=.5*(x[0].pageY+x[1].pageY);j.set(t,f)}}function Te(){const t=x[0].pageX-x[1].pageX,f=x[0].pageY-x[1].pageY,w=Math.sqrt(t*t+f*f);R.set(0,w)}function st(){e.enableZoom&&Te(),e.enablePan&&Se()}function at(){e.enableZoom&&Te(),e.enableRotate&&Pe()}function Oe(t){if(x.length==1)m.set(t.pageX,t.pageY);else{const w=Me(t),z=.5*(t.pageX+w.x),G=.5*(t.pageY+w.y);m.set(z,G)}T.subVectors(m,E).multiplyScalar(e.rotateSpeed);const f=e.domElement;f&&(B(2*Math.PI*T.x/f.clientHeight),X(2*Math.PI*T.y/f.clientHeight)),E.copy(m)}function Ae(t){if(x.length==1)P.set(t.pageX,t.pageY);else{const f=Me(t),w=.5*(t.pageX+f.x),z=.5*(t.pageY+f.y);P.set(w,z)}L.subVectors(P,j).multiplyScalar(e.panSpeed),$(L.x,L.y),j.copy(P)}function Ce(t){const f=Me(t),w=t.pageX-f.x,z=t.pageY-f.y,G=Math.sqrt(w*w+z*z);v.set(0,G),y.set(0,Math.pow(v.y/R.y,e.zoomSpeed)),W(y.y),R.copy(v)}function it(t){e.enableZoom&&Ce(t),e.enablePan&&Ae(t)}function ct(t){e.enableZoom&&Ce(t),e.enableRotate&&Oe(t)}function Re(t){var f,w;e.enabled!==!1&&(x.length===0&&((f=e.domElement)==null||f.ownerDocument.addEventListener("pointermove",ge),(w=e.domElement)==null||w.ownerDocument.addEventListener("pointerup",xe)),ft(t),t.pointerType==="touch"?dt(t):lt(t))}function ge(t){e.enabled!==!1&&(t.pointerType==="touch"?ht(t):ut(t))}function xe(t){var f,w,z;_e(t),x.length===0&&((f=e.domElement)==null||f.releasePointerCapture(t.pointerId),(w=e.domElement)==null||w.ownerDocument.removeEventListener("pointermove",ge),(z=e.domElement)==null||z.ownerDocument.removeEventListener("pointerup",xe)),e.dispatchEvent(p),a=u.NONE}function ze(t){_e(t)}function lt(t){let f;switch(t.button){case 0:f=e.mouseButtons.LEFT;break;case 1:f=e.mouseButtons.MIDDLE;break;case 2:f=e.mouseButtons.RIGHT;break;default:f=-1}switch(f){case ee.DOLLY:if(e.enableZoom===!1)return;be(t),a=u.DOLLY;break;case ee.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;je(t),a=u.PAN}else{if(e.enableRotate===!1)return;ce(t),a=u.ROTATE}break;case ee.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;ce(t),a=u.ROTATE}else{if(e.enablePan===!1)return;je(t),a=u.PAN}break;default:a=u.NONE}a!==u.NONE&&e.dispatchEvent(c)}function ut(t){if(e.enabled!==!1)switch(a){case u.ROTATE:if(e.enableRotate===!1)return;et(t);break;case u.DOLLY:if(e.enableZoom===!1)return;tt(t);break;case u.PAN:if(e.enablePan===!1)return;nt(t);break}}function Ie(t){e.enabled===!1||e.enableZoom===!1||a!==u.NONE&&a!==u.ROTATE||(t.preventDefault(),e.dispatchEvent(c),rt(t),e.dispatchEvent(p))}function ye(t){e.enabled===!1||e.enablePan===!1||ot(t)}function dt(t){switch(De(t),x.length){case 1:switch(e.touches.ONE){case te.ROTATE:if(e.enableRotate===!1)return;Pe(),a=u.TOUCH_ROTATE;break;case te.PAN:if(e.enablePan===!1)return;Se(),a=u.TOUCH_PAN;break;default:a=u.NONE}break;case 2:switch(e.touches.TWO){case te.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;st(),a=u.TOUCH_DOLLY_PAN;break;case te.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;at(),a=u.TOUCH_DOLLY_ROTATE;break;default:a=u.NONE}break;default:a=u.NONE}a!==u.NONE&&e.dispatchEvent(c)}function ht(t){switch(De(t),a){case u.TOUCH_ROTATE:if(e.enableRotate===!1)return;Oe(t),e.update();break;case u.TOUCH_PAN:if(e.enablePan===!1)return;Ae(t),e.update();break;case u.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;it(t),e.update();break;case u.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;ct(t),e.update();break;default:a=u.NONE}}function Le(t){e.enabled!==!1&&t.preventDefault()}function ft(t){x.push(t)}function _e(t){delete I[t.pointerId];for(let f=0;f<x.length;f++)if(x[f].pointerId==t.pointerId){x.splice(f,1);return}}function De(t){let f=I[t.pointerId];f===void 0&&(f=new H,I[t.pointerId]=f),f.set(t.pageX,t.pageY)}function Me(t){const f=t.pointerId===x[0].pointerId?x[1]:x[0];return I[f.pointerId]}o!==void 0&&this.connect(o),this.update()}};const an=r=>typeof r=="object"&&typeof r.then=="function",me=[];function cn(r,n,o=(e,l)=>e===l){if(r===n)return!0;if(!r||!n)return!1;const e=r.length;if(n.length!==e)return!1;for(let l=0;l<e;l++)if(!o(r[l],n[l]))return!1;return!0}function ln(r,n=null,o=!1,e={}){n===null&&(n=[r]);for(const c of me)if(cn(n,c.keys,c.equal)){if(o)return;if(Object.prototype.hasOwnProperty.call(c,"error"))throw c.error;if(Object.prototype.hasOwnProperty.call(c,"response"))return e.lifespan&&e.lifespan>0&&(c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout(c.remove,e.lifespan)),c.response;if(!o)throw c.promise}const l={keys:n,equal:e.equal,remove:()=>{const c=me.indexOf(l);c!==-1&&me.splice(c,1)},promise:(an(r)?r:r(...n)).then(c=>{l.response=c,e.lifespan&&e.lifespan>0&&(l.timeout=setTimeout(l.remove,e.lifespan))}).catch(c=>l.error=c)};if(me.push(l),!o)throw l.promise}const Ve=(r,n,o)=>ln(r,n,!1,o),un=i.forwardRef(({sdfGlyphSize:r=64,anchorX:n="center",anchorY:o="middle",font:e,fontSize:l=1,children:c,characters:p,onSync:u,...a},S)=>{const{Text:h,preloadFont:b}=Ve(async()=>Ot(()=>import("./troika-three-text.esm-2c314836.js"),["assets/troika-three-text.esm-2c314836.js","assets/index-fcb9c602.js","assets/index-ce0d8080.css"]),[]),g=F(({invalidate:T})=>T),[d]=i.useState(()=>new h),[E,m]=i.useMemo(()=>{const T=[];let j="";return i.Children.forEach(c,P=>{typeof P=="string"||typeof P=="number"?j+=P:T.push(P)}),[T,j]},[c]);return Ve(()=>new Promise(T=>b({font:e,characters:p},T)),["troika-text",e,p]),i.useLayoutEffect(()=>void d.sync(()=>{g(),u&&u(d)})),i.useEffect(()=>()=>d.dispose(),[d]),i.createElement("primitive",pe({object:d,ref:S,font:e,text:m,anchorX:n,anchorY:o,fontSize:l,sdfGlyphSize:r},a),E)}),dn=i.forwardRef(({makeDefault:r,camera:n,regress:o,domElement:e,enableDamping:l=!0,keyEvents:c=!1,onChange:p,onStart:u,onEnd:a,...S},h)=>{const b=F(y=>y.invalidate),g=F(y=>y.camera),d=F(y=>y.gl),E=F(y=>y.events),m=F(y=>y.setEvents),T=F(y=>y.set),j=F(y=>y.get),P=F(y=>y.performance),L=n||g,R=e||E.connected||d.domElement,v=i.useMemo(()=>new sn(L),[L]);return ne(()=>{v.enabled&&v.update()},-1),i.useEffect(()=>(c&&v.connect(c===!0?R:c),v.connect(R),()=>void v.dispose()),[c,R,o,v,b]),i.useEffect(()=>{const y=A=>{b(),o&&P.regress(),p&&p(A)},_=A=>{u&&u(A)},O=A=>{a&&a(A)};return v.addEventListener("change",y),v.addEventListener("start",_),v.addEventListener("end",O),()=>{v.removeEventListener("start",_),v.removeEventListener("end",O),v.removeEventListener("change",y)}},[p,u,a,v,b,m]),i.useEffect(()=>{if(r){const y=j().controls;return T({controls:v}),()=>T({controls:y})}},[r,v]),i.createElement("primitive",pe({ref:h,object:v,enableDamping:l},S))});function hn({all:r,scene:n,camera:o}){const e=F(({gl:p})=>p),l=F(({camera:p})=>p),c=F(({scene:p})=>p);return i.useLayoutEffect(()=>{const p=[];r&&(n||c).traverse(S=>{S.visible===!1&&(p.push(S),S.visible=!0)}),e.compile(n||c,o||l);const u=new At(128);new Ct(.01,1e5,u).update(e,n||c),u.dispose(),p.forEach(S=>S.visible=!1)},[]),null}function fn(r,n=!1){const o=r[0].index!==null,e=new Set(Object.keys(r[0].attributes)),l=new Set(Object.keys(r[0].morphAttributes)),c={},p={},u=r[0].morphTargetsRelative,a=new Rt;let S=0;for(let h=0;h<r.length;++h){const b=r[h];let g=0;if(o!==(b.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const d in b.attributes){if(!e.has(d))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+d+'" attribute exists among all geometries, or in none of them.'),null;c[d]===void 0&&(c[d]=[]),c[d].push(b.attributes[d]),g++}if(g!==e.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(u!==b.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const d in b.morphAttributes){if(!l.has(d))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;p[d]===void 0&&(p[d]=[]),p[d].push(b.morphAttributes[d])}if(n){let d;if(o)d=b.index.count;else if(b.attributes.position!==void 0)d=b.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;a.addGroup(S,d,h),S+=d}}if(o){let h=0;const b=[];for(let g=0;g<r.length;++g){const d=r[g].index;for(let E=0;E<d.count;++E)b.push(d.getX(E)+h);h+=r[g].attributes.position.count}a.setIndex(b)}for(const h in c){const b=Ke(c[h]);if(!b)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" attribute."),null;a.setAttribute(h,b)}for(const h in p){const b=p[h][0].length;if(b===0)break;a.morphAttributes=a.morphAttributes||{},a.morphAttributes[h]=[];for(let g=0;g<b;++g){const d=[];for(let m=0;m<p[h].length;++m)d.push(p[h][m][g]);const E=Ke(d);if(!E)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+h+" morphAttribute."),null;a.morphAttributes[h].push(E)}}return a}function Ke(r){let n,o,e,l=0;for(let u=0;u<r.length;++u){const a=r[u];if(a.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(n===void 0&&(n=a.array.constructor),n!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(o===void 0&&(o=a.itemSize),o!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(e===void 0&&(e=a.normalized),e!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;l+=a.array.length}const c=new n(l);let p=0;for(let u=0;u<r.length;++u)c.set(r[u].array,p),p+=r[u].array.length;return new zt(c,o,e)}const mn=({mulcherRef:r,engagementRef:n})=>{const o=i.useRef(),e=i.useRef(),l=i.useRef(),c=i.useRef(),p=i.useRef(),u=i.useMemo(()=>new ie,[]),a=18,S=i.useRef(),h=i.useRef(),b=i.useMemo(()=>new ie,[]),g=i.useMemo(()=>Array.from({length:28},(O,A)=>A/28),[]),d=i.useRef(0),E=i.useRef(-3.2),m=i.useRef(-3.2),T=i.useRef(0),j=i.useRef(0),P="#1b1d22",L="#0b0c0f",R="#c38b22",v="#1d1d1d",y="#141414";i.useEffect(()=>{if(p.current){for(let O=0;O<a;O+=1){const A=O/a*Math.PI*2,x=.45;u.position.set(0,Math.cos(A)*x,Math.sin(A)*x),u.rotation.set(Math.PI/2,0,A),u.scale.set(.07,.2,.22),u.updateMatrix(),p.current.setMatrixAt(O,u.matrix)}p.current.instanceMatrix.needsUpdate=!0}},[a,u]);const _=(O,A)=>{O.current&&(g.forEach((x,I)=>{const k=(x+d.current+1)%1*Math.PI*2,B=Math.sin(k)*1.85,X=Math.cos(k)*.55-.55,Q=Math.cos(k)*1.85,U=-Math.sin(k)*.55;b.position.set(B,X,A),b.rotation.set(0,0,Math.atan2(U,Q)),b.updateMatrix(),O.current.setMatrixAt(I,b.matrix)}),O.current.instanceMatrix.needsUpdate=!0)};return ne((O,A)=>{const x=O.clock.elapsedTime*.25,I=-3.2+Math.sin(x)*.8;E.current=C.lerp(E.current,I,.08),o.current&&(o.current.position.x=E.current,o.current.position.z=C.lerp(o.current.position.z,Math.cos(x*.6)*.18,.05),o.current.rotation.y=C.lerp(o.current.rotation.y,Math.PI+Math.sin(x*.4)*.04,.08));const N=C.clamp((E.current-m.current)/Math.max(A,1e-4),-1.4,1.4),k=Math.sign(N)||1;m.current=E.current,T.current=C.lerp(T.current,Math.abs(N),.1),d.current=(d.current+T.current*A*.65)%1,_(S,.96),_(h,-.96);const B=1.05+((n==null?void 0:n.current)??0)*.25;e.current&&(e.current.position.y=C.lerp(e.current.position.y,B,.12));const X=.1+((n==null?void 0:n.current)??0)*.4;l.current&&(l.current.rotation.z=C.lerp(l.current.rotation.z,X,.15));const Q=Math.sin(x*.6)*.15;c.current&&(c.current.rotation.y=C.lerp(c.current.rotation.y,Q,.2));const U=((n==null?void 0:n.current)??0)>.08?9:0;j.current=C.lerp(j.current,U,.12),r.current&&(r.current.rotation.z-=j.current*A*k)}),s.jsxs("group",{ref:o,position:[0,-.75,0],children:[s.jsxs("instancedMesh",{ref:S,args:[null,null,g.length],castShadow:!0,receiveShadow:!0,children:[s.jsx("boxGeometry",{args:[.32,.14,.5]}),s.jsx("meshStandardMaterial",{color:"#111111",roughness:.7,metalness:.5})]}),s.jsxs("instancedMesh",{ref:h,args:[null,null,g.length],castShadow:!0,receiveShadow:!0,children:[s.jsx("boxGeometry",{args:[.32,.14,.5]}),s.jsx("meshStandardMaterial",{color:"#111111",roughness:.7,metalness:.5})]}),s.jsxs("mesh",{position:[0,-.05,.9],castShadow:!0,receiveShadow:!0,children:[s.jsx("boxGeometry",{args:[4.2,.4,.5]}),s.jsx("meshStandardMaterial",{color:y,roughness:.8,metalness:.35})]}),s.jsxs("mesh",{position:[0,-.05,-.9],castShadow:!0,receiveShadow:!0,children:[s.jsx("boxGeometry",{args:[4.2,.4,.5]}),s.jsx("meshStandardMaterial",{color:y,roughness:.8,metalness:.35})]}),s.jsxs("mesh",{position:[0,.9,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[3.4,1.2,2]}),s.jsx("meshStandardMaterial",{color:P,roughness:.4,metalness:.7})]}),s.jsxs("mesh",{position:[-.7,1.7,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.4,1.1,1.6]}),s.jsx("meshStandardMaterial",{color:L,roughness:.3,metalness:.6})]}),s.jsxs("mesh",{position:[0,.35,1.08],castShadow:!0,children:[s.jsx("boxGeometry",{args:[3.8,.7,.22]}),s.jsx("meshStandardMaterial",{color:R,roughness:.6,metalness:.25})]}),s.jsxs("mesh",{position:[0,.35,-1.08],castShadow:!0,children:[s.jsx("boxGeometry",{args:[3.8,.7,.22]}),s.jsx("meshStandardMaterial",{color:R,roughness:.6,metalness:.25})]}),s.jsxs("mesh",{position:[1.95,1.05,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[.4,1.4,2.3]}),s.jsx("meshStandardMaterial",{color:v,roughness:.55,metalness:.45})]}),s.jsxs("mesh",{position:[2.15,1.58,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[.3,.24,2.4]}),s.jsx("meshStandardMaterial",{color:y,roughness:.4,metalness:.65})]}),s.jsxs("mesh",{position:[1.65,1.35,.95],castShadow:!0,rotation:[0,0,-Math.PI/12],children:[s.jsx("boxGeometry",{args:[1.2,.15,.2]}),s.jsx("meshStandardMaterial",{color:y,roughness:.45,metalness:.55})]}),s.jsxs("mesh",{position:[1.65,1.35,-.95],castShadow:!0,rotation:[0,0,Math.PI/12],children:[s.jsx("boxGeometry",{args:[1.2,.15,.2]}),s.jsx("meshStandardMaterial",{color:y,roughness:.45,metalness:.55})]}),s.jsxs("mesh",{position:[-.35,2,.8],castShadow:!0,children:[s.jsx("boxGeometry",{args:[.5,.2,.22]}),s.jsx("meshStandardMaterial",{color:v,roughness:.4,metalness:.55})]}),s.jsxs("mesh",{position:[-.35,2,.8],children:[s.jsx("boxGeometry",{args:[.28,.12,.12]}),s.jsx("meshStandardMaterial",{color:"#f6dba1",emissive:"#f6c66a",emissiveIntensity:1.5})]}),s.jsxs("mesh",{position:[-.35,2,-.8],castShadow:!0,children:[s.jsx("boxGeometry",{args:[.5,.2,.22]}),s.jsx("meshStandardMaterial",{color:v,roughness:.4,metalness:.55})]}),s.jsxs("mesh",{position:[-.35,2,-.8],children:[s.jsx("boxGeometry",{args:[.28,.12,.12]}),s.jsx("meshStandardMaterial",{color:"#f6dba1",emissive:"#f6c66a",emissiveIntensity:1.5})]}),s.jsxs("group",{ref:e,position:[0,1.05,0],children:[s.jsxs("mesh",{position:[1.2,.1,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.2,.4,.4]}),s.jsx("meshStandardMaterial",{color:y,roughness:.35,metalness:.55})]}),s.jsxs("group",{ref:l,position:[1.4,.9,0],children:[s.jsxs("mesh",{position:[.8,.1,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.6,.35,.35]}),s.jsx("meshStandardMaterial",{color:y,metalness:.7,roughness:.25})]}),s.jsxs("group",{ref:c,position:[1.6,0,0],children:[s.jsxs("mesh",{position:[.4,-.05,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.7,.5,2.1]}),s.jsx("meshStandardMaterial",{color:v,roughness:.55,metalness:.35})]}),s.jsxs("mesh",{position:[.95,.25,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[.35,.9,2.25]}),s.jsx("meshStandardMaterial",{color:y,roughness:.5,metalness:.45})]}),s.jsxs("mesh",{position:[.2,.3,0],castShadow:!0,children:[s.jsx("boxGeometry",{args:[1.1,.2,2.4]}),s.jsx("meshStandardMaterial",{color:v,roughness:.5,metalness:.3})]}),s.jsxs("group",{ref:r,position:[.5,0,0],rotation:[Math.PI/2,Math.PI/2,0],children:[s.jsxs("mesh",{castShadow:!0,children:[s.jsx("cylinderGeometry",{args:[.4,.4,1.4,24,1,!0]}),s.jsx("meshStandardMaterial",{color:R,emissive:"#5a3107",emissiveIntensity:.45,roughness:.35,metalness:.4})]}),s.jsxs("instancedMesh",{ref:p,args:[null,null,a],castShadow:!0,children:[s.jsx("boxGeometry",{args:[.25,.05,.08]}),s.jsx("meshStandardMaterial",{color:"#f4b15c",emissive:"#612800",emissiveIntensity:.3})]})]})]})]})]}),s.jsxs("mesh",{position:[.6,.9,-1.05],children:[s.jsx("boxGeometry",{args:[1.2,.8,.1]}),s.jsx("meshStandardMaterial",{color:v,roughness:.5})]}),s.jsx(un,{position:[.1,1.35,1.01],rotation:[0,-Math.PI/2,0],fontSize:.32,color:"#f8f6f2",maxWidth:2.5,anchorX:"center",anchorY:"middle",children:"BGG Land Management"})]})},pn=({mulcherRef:r,engagementRef:n})=>{const o=i.useRef(),e=i.useRef(),l=i.useMemo(()=>new ie,[]),c=i.useMemo(()=>new ie,[]),p=i.useMemo(()=>new D,[]),u=i.useMemo(()=>new D,[]),a=i.useMemo(()=>{const g=[],E=new he("#1d1a15"),m=new he("#5f6c48");for(let j=0;j<6;j+=1){const L=.02+Math.random()*.015,R=new Lt(L*.4,L,2.4,6,4,!0),v=.08+Math.random()*.08,y=Math.random()*Math.PI*2;R.translate(Math.cos(y)*v,2.4/2,Math.sin(y)*v);const _=R.attributes.position,O=[];for(let A=0;A<_.count;A+=1){const x=C.clamp(_.getY(A)/2.4,0,1),I=E.clone().lerp(m,Math.pow(x,.85)),N=C.lerp(.65,1,x);O.push(I.r*N,I.g*N,I.b*N)}R.setAttribute("color",new _t(O,3)),g.push(R)}const T=fn(g,!1);return T.computeVertexNormals(),T},[]),S=i.useMemo(()=>{const g=new Dt(.2,.6,1,1);return g.translate(0,.3,0),g},[]),{clusters:h,leaves:b}=i.useMemo(()=>{const g=Array.from({length:14}).map(()=>({center:new D(-3.4+C.randFloatSpread(1.4),-1,-.4+Math.random()*11),weight:.5+Math.random()*.8})),d=[],E=[];return g.forEach(m=>{const T=2+Math.floor(Math.random()*4);for(let j=0;j<T;j+=1){if(Math.random()<.18)continue;const P=Math.random()*.55*m.weight,L=Math.random()*Math.PI*2,R=Math.cos(L)*P,v=Math.sin(L)*P,y=d.length;d.push({position:new D(m.center.x+R,-1,m.center.z+v*.65),yaw:C.randFloatSpread(.4),height:1.6+Math.random()*1.2,width:.45+Math.random()*.35,bend:0,decay:1,vanish:0,swayOffset:Math.random()*Math.PI*2});const _=2+Math.floor(Math.random()*3);for(let O=0;O<_;O+=1){const A=new D(C.randFloatSpread(.25),.6+Math.random()*.4,C.randFloatSpread(.25)),x=new he("#384a32"),I=new he("#6c7d4f"),N=x.clone().lerp(I,Math.random()*.6+.2);E.push({clusterIndex:y,offset:A,tilt:C.randFloatSpread(.25),twist:C.randFloatSpread(.3),scale:.12+Math.random()*.08,color:N})}}}),{clusters:d,leaves:E}},[]);return i.useEffect(()=>{!o.current||!a||(h.forEach((g,d)=>{l.position.set(g.position.x,-1+g.height*.5,g.position.z),l.scale.set(g.width,g.height,g.width*.8),l.rotation.set(0,g.yaw,0),l.updateMatrix(),o.current.setMatrixAt(d,l.matrix)}),o.current.instanceMatrix.needsUpdate=!0)},[h,a,l]),i.useEffect(()=>{!e.current||!S||(b.forEach((g,d)=>{c.position.copy(g.offset),c.updateMatrix(),e.current.setMatrixAt(d,c.matrix),e.current.instanceColor&&e.current.setColorAt(d,g.color)}),e.current.instanceMatrix.needsUpdate=!0,e.current.instanceColor&&(e.current.instanceColor.needsUpdate=!0))},[b,S,c]),ne(g=>{if(!o.current||!r.current)return;r.current.getWorldPosition(p);let d=1/0;h.forEach((m,T)=>{u.set(p.x-m.position.x,0,p.z-m.position.z);const j=u.length();d=Math.min(d,j);const L=C.clamp(1-(j-.8)/1.5,0,1)*.4;m.bend=C.lerp(m.bend,L,.12);const R=j<.85?1:0,v=R?.45:.06;m.decay=C.lerp(m.decay,R?0:1,v),m.vanish=C.lerp(m.vanish,R,v);const y=Math.max(0,1-m.vanish),_=Math.max(.05,m.height*m.decay),O=Math.max(.02,m.width*(.7+.3*y)),A=Math.sin(m.swayOffset+g.clock.elapsedTime*.4)*.04*y;j>.001&&u.normalize();const x=u.x*(m.bend+A),I=u.z*(m.bend+A);l.position.set(m.position.x,-1+_*.5,m.position.z),l.scale.set(O,_,O*.78),l.rotation.set(-I,m.yaw,x),l.updateMatrix(),o.current.setMatrixAt(T,l.matrix),m.currentHeight=_,m.currentWidth=O,m.currentLeanX=x,m.currentLeanZ=I,m.living=y}),o.current.instanceMatrix.needsUpdate=!0,e.current&&(b.forEach((m,T)=>{const j=h[m.clusterIndex];if(!j)return;const P=j.living??0,L=j.currentHeight??j.height,R=j.currentWidth??j.width,v=j.currentLeanZ??0,y=R*.6;c.position.set(j.position.x+m.offset.x*y,-1+L*m.offset.y,j.position.z+m.offset.z*y);const _=m.scale*C.clamp(P,0,1);c.scale.set(_,_,_),c.rotation.set(-v+m.tilt,(j.yaw??0)+m.twist,0),c.updateMatrix(),e.current.setMatrixAt(T,c.matrix)}),e.current.instanceMatrix.needsUpdate=!0);const E=C.clamp(d<.9?1:d<2.2?.45:0,0,1);n&&(n.current=C.lerp(n.current??0,E,.15))}),!h.length||!a?null:s.jsxs("group",{children:[s.jsx("instancedMesh",{ref:o,args:[a,null,h.length],castShadow:!0,receiveShadow:!0,children:s.jsx("meshStandardMaterial",{vertexColors:!0,roughness:.95,metalness:.08})}),b.length>0&&s.jsx("instancedMesh",{ref:e,args:[S,null,b.length],castShadow:!0,children:s.jsx("meshStandardMaterial",{vertexColors:!0,transparent:!0,opacity:.55,roughness:.8,metalness:.05,side:Gt})})]})},bn=({sourceRef:r,engagementRef:n})=>{const e=i.useRef(),l=i.useRef(),c=i.useMemo(()=>new Array(70).fill().map(()=>({direction:new D(.7+Math.random()*.6,-(.15+Math.random()*.35),C.randFloatSpread(.35)).normalize(),life:Math.random()*.8,speed:.5+Math.random()*.8})),[70]),p=i.useMemo(()=>new Float32Array(70*3),[70]),u=i.useMemo(()=>new D,[]),a=i.useMemo(()=>new D,[]);return ne((S,h)=>{if(!e.current||!r.current)return;r.current.getWorldPosition(a);const b=C.clamp((n==null?void 0:n.current)??0,0,1),g=e.current.geometry.attributes.position.array;c.forEach((d,E)=>{const m=C.lerp(.15,1,b);d.life+=h*d.speed*m,d.life>1.3&&(d.life=Math.random()*.15,d.direction.set(.7+Math.random()*.6,-(.15+Math.random()*.35),C.randFloatSpread(.35)).normalize()),u.copy(d.direction).multiplyScalar(d.life*1.8).add(a),u.x+=.25,u.y-=d.life*.15,u.z+=C.randFloatSpread(.05);const T=E*3;g[T]=u.x,g[T+1]=u.y,g[T+2]=u.z}),e.current.geometry.attributes.position.needsUpdate=!0,l.current&&(l.current.opacity=C.lerp(l.current.opacity,.85*b,.2))}),s.jsxs("points",{ref:e,frustumCulled:!1,children:[s.jsx("bufferGeometry",{children:s.jsx("bufferAttribute",{attach:"attributes-position",array:p,count:p.length/3,itemSize:3})}),s.jsx("pointsMaterial",{ref:l,color:"#f6d7a7",size:.08,sizeAttenuation:!0,transparent:!0,opacity:.05})]})},gn=({mulcherRef:r})=>{const n=i.useRef(),o=i.useMemo(()=>new ie,[]),e=i.useRef([]),l=18,c=i.useMemo(()=>new D,[]);return ne((p,u)=>{if(!(!r.current||!n.current)){r.current.getWorldPosition(c),e.current.unshift({position:c.clone(),life:1}),e.current.length>l&&e.current.pop(),e.current.forEach((a,S)=>{a.life=Math.max(0,a.life-u*.18),o.position.set(a.position.x+1.25,-1.22,a.position.z),o.scale.set(1.2+a.life*1.6,1,2.2),o.rotation.set(-Math.PI/2,Math.PI/2,0),o.updateMatrix(),n.current.setMatrixAt(S,o.matrix)});for(let a=e.current.length;a<l;a+=1)o.scale.set(0,0,0),o.updateMatrix(),n.current.setMatrixAt(a,o.matrix);n.current.instanceMatrix.needsUpdate=!0}}),s.jsxs("instancedMesh",{ref:n,args:[null,null,l],receiveShadow:!0,children:[s.jsx("planeGeometry",{args:[1.4,2]}),s.jsx("meshStandardMaterial",{color:"#1a140c",roughness:1,metalness:0,transparent:!0,opacity:.92})]})},xn=({sourceRef:r,engagementRef:n})=>{const e=i.useRef(),l=i.useRef(),c=i.useMemo(()=>new Float32Array(40*3),[40]),p=i.useMemo(()=>new Array(40).fill().map(()=>({offset:Math.random()*.4,life:Math.random(),direction:new D(.45+Math.random()*.4,-(.05+Math.random()*.18),C.randFloatSpread(.4))})),[40]),u=i.useMemo(()=>new D,[]),a=i.useMemo(()=>new D,[]);return ne((S,h)=>{if(!r.current||!e.current)return;r.current.getWorldPosition(u);const b=C.clamp((n==null?void 0:n.current)??0,0,1),g=e.current.geometry.attributes.position.array;p.forEach((d,E)=>{d.life+=h*C.lerp(.1,.5,b),d.life>1&&(d.life=Math.random()*.1,d.direction.set(.45+Math.random()*.4,-(.05+Math.random()*.18),C.randFloatSpread(.4))),a.copy(d.direction).multiplyScalar(1.8*d.life+d.offset).add(u),a.x+=.2,a.y-=d.life*.1,a.z+=C.randFloatSpread(.04);const m=E*3;g[m]=a.x,g[m+1]=a.y,g[m+2]=a.z}),e.current.geometry.attributes.position.needsUpdate=!0,l.current&&(l.current.opacity=C.lerp(l.current.opacity,.28*b,.15))}),s.jsxs("points",{ref:e,frustumCulled:!1,children:[s.jsx("bufferGeometry",{children:s.jsx("bufferAttribute",{attach:"attributes-position",array:c,count:c.length/3,itemSize:3})}),s.jsx("pointsMaterial",{ref:l,color:"#c2b7aa",size:.12,sizeAttenuation:!0,transparent:!0,opacity:.04})]})},yn=()=>{const r=i.useRef(),n=i.useRef(0);return s.jsxs("group",{dispose:null,children:[s.jsx("fog",{attach:"fog",args:["#020305",10,30]}),s.jsx("hemisphereLight",{intensity:.25,groundColor:"#0b0b0b"}),s.jsx("spotLight",{position:[4,6,6],angle:.6,penumbra:.9,intensity:2.2,color:"#f7d7a7",castShadow:!0,"shadow-mapSize":1024}),s.jsx("directionalLight",{position:[-6,4,-4],intensity:1.5,color:"#94c2ff",castShadow:!0}),s.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-1.2,0],receiveShadow:!0,children:[s.jsx("planeGeometry",{args:[50,50]}),s.jsx("meshStandardMaterial",{color:"#050505",roughness:1,metalness:0})]}),s.jsx(gn,{mulcherRef:r}),s.jsx(mn,{mulcherRef:r,engagementRef:n}),s.jsx(pn,{mulcherRef:r,engagementRef:n}),s.jsx(bn,{sourceRef:r,engagementRef:n}),s.jsx(xn,{sourceRef:r,engagementRef:n})]})},jn=()=>{const[r,n]=i.useState(!1);return i.useEffect(()=>{const o=window.matchMedia("(max-width: 640px)");n(o.matches);const e=l=>n(l.matches);return o.addEventListener("change",e),()=>o.removeEventListener("change",e)},[]),s.jsxs(tn,{shadows:!0,dpr:[1,2],camera:r?{position:[4,2.2,10],fov:38}:{position:[6,1.8,9],fov:32},gl:{preserveDrawingBuffer:!0},children:[s.jsxs(i.Suspense,{fallback:s.jsx(It,{}),children:[s.jsx(dn,{enableZoom:!1,enablePan:!1,enableRotate:!1,maxPolarAngle:Math.PI/2.4,minPolarAngle:Math.PI/2.6}),s.jsx(yn,{})]}),s.jsx(hn,{all:!0})]})};export{jn as default};
